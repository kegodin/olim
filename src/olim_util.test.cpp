#include "olim_util.hpp"
#include "speed_funcs.hpp"
#include "test.hpp"

void figuring_it_out() {}

void sturm_works_1() {
  double a[] = {
    -0.0019249999999999998,
    -0.0010000000000000002,
    0.00087500000000000078,
    -0.0020000000000000005,
    0.00040000000000000018
  };
  double b[] = {
    -0.0010000000000000002,
    0.0017500000000000016,
    -0.0060000000000000019,
    0.0016000000000000007
  };
  double c[] = {
    0.0022374999999999999,
    0.00020312499999999986,
    0.0014374999999999998
  };
  double d[] = {
    -0.0086910396975425352,
    -0.0051202079395085099
  };
  double e[] = {
    -0.006034391692523379
  };
  double * polys[] = {a, b, c, d, e};
  test::is_true(sturm(polys, 0, 1) == 0);
}

void sturm_works_2() {
  double a[] = {
    0.0044039823074159008,
    -0.018607964614831808,
    0.018607964614831819,
    -0.000000000000000015543122344752199,
    0.0000000000000000000000000000000030814879110195774
  };
  double b[] = {
    -0.018607964614831808,
    0.037215929229663637,
    -0.000000000000000046629367034256598,
    0.000000000000000000000000000000012325951644078309
  };
  double c[] = {
    5866197575383.5918,
    -11732395150767.186,
    0.0053960176925841059
  };
  double d[] = {
    -0.0029492948003932741,
    0.00589858960078653
  };
  double e[] = {
    0.0185546875
  };
  double * polys[] = {a, b, c, d, e};
  test::is_true(sturm(polys, 0, 1) == 2);
  test::is_true(sturm(polys, 0, 0.5) == 1);
  test::is_true(sturm(polys, 0.5, 1) == 1);
  test::is_true(sturm(polys, 0.4, 0.5) == 0);
  test::is_true(sturm(polys, 0.49999999999999994, 0.5) == 0);
}

void sturm_works_3() {
  double a[] = {
    0.000075000000000000007,
    -0.00020000000000000001,
    0.000475,
    -0.00040000000000000002,
    0.00040000000000000002
  };
  double b[] = {
    -0.00020000000000000001,
    0.00094999999999999999,
    -0.0012000000000000001,
    0.0016000000000000001
  };
  double c[] = {
    -0.000062500000000000001,
    0.000090625000000000021,
    -0.00016249999999999999
  };
  double d[] = {
    0.000081656804733727889,
    -0.0013937869822485207
  };
  double e[] = {
    0.000057748375077573313
  };
  double * polys[] = {a, b, c, d, e};
  test::is_true(sturm(polys, 0, 1) == 0);
}

int main() {
  figuring_it_out();
  sturm_works_1();
  sturm_works_2();
  sturm_works_3();
}

// Local Variables:
// indent-tabs-mode: nil
// c-basic-offset: 2
// End:
